<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ROBLOXXED - Recommended</title>
<style>
  body {
    background-color: #ffffff; /* white background */
    color: #003366; /* dark blue text */
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 20px;
    text-align: center;
  }
  .logo {
    max-width: 400px;
    margin-bottom: 20px;
  }
  nav {
    margin-bottom: 20px;
  }
  nav a {
    color: #004080; /* medium blue links */
    text-decoration: none;
    margin: 0 15px;
    font-weight: bold;
    font-size: 1.1em;
  }
  nav a:hover {
    text-decoration: underline;
  }
  #searchBar {
    padding: 10px;
    width: 300px;
    font-size: 16px;
    border-radius: 5px;
    border: 2px solid #0066cc; /* blue border */
    margin-bottom: 30px;
    color: #003366;
  }
  .games-container {
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(250px,1fr));
    gap: 20px;
    justify-items: center;
  }
  .game {
    background-color: #e6f0ff; /* very light blue background */
    border: 2px solid #0073e6; /* bright blue border */
    border-radius: 10px;
    padding: 15px;
    width: 250px;
    box-sizing: border-box;
    text-align: center;
    color: #003366; /* dark blue text */
  }
  .game img {
    width: 100%;
    border-radius: 5px;
    border: 1px solid #0073e6;
  }
  .game h2 {
    margin: 10px 0 5px 0;
    font-size: 1.2em;
  }
  .game p {
    margin: 0 0 10px 0;
    font-weight: bold;
    color: #0059b3; /* medium blue text */
  }
  .game button {
    background-color: #0073e6; /* bright blue */
    color: white;
    border: none;
    padding: 10px 20px;
    font-weight: bold;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  .game button:hover {
    background-color: #005bb5; /* darker blue on hover */
  }
  p.no-games {
    color: #004080;
    font-weight: bold;
    font-size: 1.2em;
  }
</style>
</head>
<body>
  <img src="robloxxed_logo.png" alt="ROBLOXXED Logo" class="logo" />

  <nav>
    <a href="index.html">Home</a>
    <a href="recommended.html">Recommended</a>
    <a href="charts.html">Charts</a>
    <a href="others.html">Others</a>
  </nav>

  <input
    type="text"
    id="searchBar"
    placeholder="Search games..."
    onkeyup="filterGames()"
  />

  <div class="games-container" id="gameList">
    Loading games...
  </div>

  <script>
    let allGames = [];

    async function fetchGames() {
      try {
        const response = await fetch('games.json');
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        allGames = await response.json();
        console.log('Loaded games:', allGames);
      } catch (e) {
        console.error('Failed to load games.json', e);
        document.getElementById('gameList').innerHTML =
          '<p class="no-games">Failed to load games.</p>';
      }
    }

    function renderGames(games) {
      const container = document.getElementById('gameList');
      container.innerHTML = '';

      if (!games.length) {
        container.innerHTML = '<p class="no-games">No games found.</p>';
        return;
      }

      games.forEach((game) => {
        const div = document.createElement('div');
        div.className = 'game';
        div.innerHTML = `
          <img src="${game.thumbnail}" alt="${game.name}" />
          <h2>${game.name}</h2>
          <p>By ${game.creator}</p>
          <button onclick="location.href='roblox://placeId=${game.id}'">Play</button>
        `;
        container.appendChild(div);
      });
    }

    function filterGames() {
      const query = document
        .getElementById('searchBar')
        .value.toLowerCase()
        .trim();

      if (!allGames.length) {
        // No games loaded yet, do nothing or show loading
        document.getElementById('gameList').innerHTML = 'Loading games...';
        return;
      }

      if (!query) {
        renderGames(allGames.slice(0, 20));
        return;
      }

      const filtered = allGames.filter(
        (game) =>
          game.name.toLowerCase().includes(query) ||
          game.creator.toLowerCase().includes(query)
      );

      renderGames(filtered);
    }

    function getRandomGames(count = 20) {
      const shuffled = allGames
        .slice()
        .sort(() => Math.random() - 0.5)
        .slice(0, count);
      return shuffled;
    }

    async function updateRandomGames() {
      if (!allGames.length) {
        await fetchGames();
      }
      renderGames(getRandomGames(20));
    }

    // Update recommended games every second
    setInterval(updateRandomGames, 1000);

    // Initial load
    window.onload = async () => {
      await fetchGames();
      updateRandomGames();
    };
  </script>
</body>
</html>
